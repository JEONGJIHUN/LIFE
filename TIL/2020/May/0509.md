# Web Architecture 101

<img src="https://miro.medium.com/max/1330/1*K6M-x-6e39jMq_c-2xqZIQ.png" />

## 1. DNS

DNS는 "Domain Name System"의 약자이며 월드 와이드 웹을 가능하게하는 중추 기술입니다. 가장 기본적인 수준에서 DNS는 도메인 이름 (예 : google.com)에서 IP 주소 (예 : 85.129.83.120)로 키 / 값 조회를 제공합니다.이 정보는 컴퓨터가 해당 요청을 적절한 주소로 라우팅하는 데 필요합니다. 섬기는 사람. 전화 번호와 유사하게 도메인 이름과 IP 주소의 차이는 "John Johne 전화"와 "전화 201-867–5309"의 차이입니다. 이전에 John의 번호를 조회하기 위해 전화 번호부가 필요했던 것처럼 도메인의 IP 주소를 조회하려면 DNS가 필요합니다. 따라서 DNS를 인터넷 전화 번호부로 생각할 수 있습니다.
여기에 더 많은 세부 정보가 있지만 101 레벨 소개에 중요하지 않기 때문에 건너 뛸 것입니다.

## 2. 로드 밸런서

로드 밸런싱에 대한 자세한 내용을 살펴보기 전에 수평 및 수직 애플리케이션 스케일링에 대해 논의하기 위해 물러나야합니다. 그것들은 무엇이며 차이점은 무엇입니까? 이 StackOverflow 게시물 에 간단히 넣 습니다 .수평 확장은 리소스 풀에 더 많은 시스템을 추가하여 확장하는 것을 의미하는 반면, "수직"확장은 기존 시스템에 더 많은 전력 (예 : CPU, RAM)을 추가하여 확장 할 수 있음을 의미합니다.

웹 개발에서, 당신은 (거의) 항상 수평으로 확장하기를 원합니다. 왜냐하면 그것을 단순하게 유지하기 위해서는 물건이 깨지기 때문입니다. 서버가 임의로 충돌합니다. 네트워크 성능이 저하됩니다. 전체 데이터 센터가 때때로 오프라인 상태가됩니다. 서버가 두 대 이상 있으면 응용 프로그램이 계속 실행되도록 중단을 계획 할 수 있습니다. 즉, 앱은 "내결함성"입니다. 두 번째로 수평 확장을 사용하면 응용 프로그램 백엔드의 서로 다른 부분 (웹 서버, 데이터베이스, 서비스 X 등)을 서로 다른 서버에서 실행하여 최소한으로 연결할 수 있습니다. 마지막으로, 더 이상 수직으로 스케일링 할 수없는 스케일에 도달 할 수 있습니다. 세상에는 앱의 모든 계산을 수행하기에 충분한 컴퓨터가 없습니다. 비록 구글의 검색 플랫폼이 전형적인 예라고 생각하면, 이것은 훨씬 작은 규모의 회사에 적용됩니다. 예를 들어 스토리 블록 특정 시점에 150 ~ 400 개의 AWS EC2 인스턴스를 실행합니다. 수직 스케일링을 통해 전체 컴퓨팅 성능을 제공하는 것은 쉽지 않습니다.

다시로드 밸런서로 돌아갑니다. 수평 확장이 가능한 마술 소스입니다. 들어오는 요청을 일반적으로 서로의 복제 / 미러 이미지 인 많은 응용 프로그램 서버 중 하나로 라우팅하고 응용 프로그램 서버에서 클라이언트로 응답을 보냅니다. 그중 하나는 요청을 동일한 방식으로 처리해야하므로 서버 세트에 요청을 분산시켜 과부하가 걸리지 않도록해야합니다.

개념적으로로드 밸런서는 매우 간단합니다. 후드 아래에는 분명히 합병증이 있지만 101 버전으로 뛰어들 필요는 없습니다.

## 3. 웹 애플리케이션 서버

높은 수준의 웹 응용 프로그램 서버에서는 설명하기가 비교적 쉽습니다. 이들은 사용자의 요청을 처리하고 HTML을 사용자의 브라우저로 보내는 핵심 비즈니스 로직을 실행합니다. 업무를 수행하기 위해 일반적으로 데이터베이스, 캐싱 계층, 작업 대기열, 검색 서비스, 기타 마이크로 서비스, 데이터 / 로깅 대기열 등과 같은 다양한 백엔드 인프라와 통신합니다. 위에서 언급 한 바와 같이, 일반적으로 사용자 요청을 처리하기 위해로드 밸런서에 2 개 이상, 종종 더 많은 수의 플러그가 연결되어 있습니다.

앱 서버 구현에는 특정 언어 (Node.js, Ruby, PHP, Scala, Java, C # .NET 등)와 해당 언어에 대한 웹 MVC 프레임 워크 (Express for Node.js, Ruby on Rails)를 선택해야합니다. , 스칼라 게임, Laravel for PHP 등). 그러나 이러한 언어와 프레임 워크에 대한 자세한 내용은이 기사에서 다루지 않습니다.

## 4. 데이터베이스 서버

모든 최신 웹 응용 프로그램은 하나 이상의 데이터베이스를 활용하여 정보를 저장합니다. 데이터베이스는 데이터 구조를 정의하고, 새 데이터를 삽입하고, 기존 데이터를 찾고, 기존 데이터를 업데이트하거나 삭제하고, 데이터에 대한 계산을 수행하는 등의 방법을 제공합니다. 대부분의 경우 웹 서버는 작업 서버와 마찬가지로 하나의 서버와 직접 통신합니다. 또한 각 백엔드 서비스에는 나머지 응용 프로그램과 격리 된 자체 데이터베이스가있을 수 있습니다.

각 아키텍처 구성 요소에 대한 특정 기술에 대한 심층적 인 다이빙을 피하고 있지만 데이터베이스에 대한 다음 수준의 세부 사항 인 SQL 및 NoSQL에 대해서는 언급하지 않아도됩니다.
SQL은 "Structured Query Language"의 약자이며 1970 년대에 광범위한 사용자가 액세스 할 수있는 관계형 데이터 세트를 쿼리하는 표준 방법을 제공하기 위해 개발되었습니다. SQL 데이터베이스는 공통 ID (일반적으로 정수)를 통해 서로 연결된 테이블에 데이터를 저장합니다. 사용자의 과거 주소 정보를 저장하는 간단한 예를 살펴 보겠습니다. 사용자 ID로 연결된 두 개의 테이블 (user 및 user_addresses)이있을 수 있습니다. 간단한 버전은 아래 이미지를 참조하십시오. user_addresses의 user_id 열이 users 테이블의 id 열에 대한 "외부 키"이므로 테이블이 연결됩니다.

SQL에 대해 잘 모르는 경우 Khan Academy 에서 찾을 수있는 자습서를 참조하십시오 . 웹 개발에 보편적으로 사용되므로 응용 프로그램을 올바르게 설계하기 위해 최소한 기본 사항을 알고 싶을 것입니다."Non-SQL"을 의미하는 NoSQL은 대규모 웹 응용 프로그램에서 생성 할 수있는 방대한 양의 데이터를 처리하기 위해 등장한 새로운 데이터베이스 기술입니다 (대부분의 SQL은 수평 적으로 잘 확장되지 않으며 특정 지점까지 수직으로 만 확장 할 수 있습니다). NoSQL에 대해 모른다면 다음과 같은 고급 소개로 시작하는 것이 좋습니다.

- https://www.w3resource.com/mongodb/nosql.php
- http://www.kdnuggets.com/2016/07/seven-steps-understanding-nosql-databases.html
- https://resources.mongodb.com/getting-started-with-mongodb/back-to-basics-1-introduction-to-nosql

또한 업계는 NoSQL 데이터베이스의 인터페이스로도 SQL을 인터페이스로 조정하고 있으므로 알지 못하는 경우 실제로 SQL을 배워야합니다. 요즘에는 피할 수있는 방법이 거의 없습니다.

## 5. 캐싱 서비스

캐싱 서비스는 간단한 키 / 값 데이터 저장소를 제공하여 O (1) 시간 가까이에 정보를 저장하고 조회 할 수 있습니다. 응용 프로그램은 일반적으로 캐싱 서비스를 활용하여 값 비싼 계산 결과를 저장하므로 다음에 필요할 때 다시 계산하는 대신 캐시에서 결과를 검색 할 수 있습니다. 응용 프로그램은 데이터베이스 쿼리, 외부 서비스 호출, 지정된 URL에 대한 HTML 등의 결과를 캐시 할 수 있습니다. 실제 응용 프로그램의 일부 예는 다음과 같습니다.

- Google은 매번 다시 계산하지 않고 "dog"또는 "Taylor Swift"와 같은 일반적인 검색어에 대한 검색 결과를 캐시합니다.
- Facebook은 게시물 데이터, 친구 등과 같이 로그인 할 때 표시되는 많은 데이터를 캐시 합니다. Facebook 캐싱 기술에 대한 자세한 기사는 여기를 참조하십시오 .
- Storyblocks는 서버 측 React 렌더링, 검색 결과, 자동 검색 결과 등의 HTML 출력을 캐시합니다. 가장 널리 사용되는 두 가지 캐싱 서버 기술은 Redis와 Memcache입니다. 다른 게시물에서 더 자세히 설명하겠습니다.

## 6. 작업 대기열 및 서버

대부분의 웹 응용 프로그램은 사용자의 요청에 직접 응답하지 않는이면에서 비동기 적으로 일부 작업을 수행해야합니다. 예를 들어 Google은 검색 결과를 반환하기 위해 전체 인터넷을 크롤링하고 색인을 생성해야합니다. 검색 할 때마다이 작업을 수행하지 않습니다. 대신, 웹을 비동기 적으로 크롤링하여 검색 색인을 업데이트합니다.

비동기 작업을 수행 할 수있는 다양한 아키텍처가 있지만 가장 보편적 인 것은 내가 "작업 큐"아키텍처라고하는 것입니다. 실행해야하는 "작업"대기열과 대기열에서 작업을 실행하는 하나 이상의 작업 서버 (종종 "작업자")로 구성됩니다.

작업 대기열은 비동기 적으로 실행해야하는 작업 목록을 저장합니다. 가장 간단한 것은 선입 선출 (FIFO) 대기열이지만 대부분의 응용 프로그램에는 일종의 우선 순위 대기열 시스템이 필요합니다. 앱이 일정한 일정에 따라 또는 사용자 작업에 따라 결정된 작업을 실행해야 할 때마다 해당 작업을 대기열에 추가하기 만하면됩니다.

예를 들어 스토리 블록은 작업 대기열을 활용하여 시장 지원에 필요한 많은 비하인드 작업을 지원합니다. 비디오 및 사진을 인코딩하고 메타 데이터 태그 지정을 위해 CSV를 처리하며 사용자 통계를 집계하고 비밀번호 재설정 이메일을 보내는 등의 작업을 수행합니다. 비밀번호 재설정 이메일 전송과 같은 시간에 민감한 작업이 최대한 빨리 완료되도록 우선 순위 대기열로 업그레이드했지만 간단한 FIFO 대기열로 시작했습니다.

작업 서버는 작업을 처리합니다. 작업 대기 행렬을 폴링하여 수행 할 작업이 있는지 확인하고 작업이있는 경우 대기 행렬에서 작업을 팝하여 실행합니다. 기본 언어 및 프레임 워크 선택은 웹 서버만큼 다양하므로이 기사에서는 자세히 다루지 않겠다.

## 7. 전문 검색 서비스

대부분의 웹 응용 프로그램은 아니지만 대부분의 웹 응용 프로그램은 사용자가 텍스트 입력 ( "쿼리"라고 함)을 제공하고 가장 "관련된"결과를 반환하는 일종의 검색 기능을 지원합니다. 이 기능을 지원하는 기술은 일반적으로 " 전체 텍스트 검색 "이라고하며, 반전 된 인덱스 를 사용하여 쿼리 키워드가 포함 된 문서를 빠르게 찾습니다.특정 키워드에서 제목에 해당 키워드가 포함 된 문서를 빠르게 조회 할 수 있도록 세 개의 문서 제목이 반전 색인으로 변환되는 방법을 보여주는 예입니다. "in", "the", "with"등과 같은 일반적인 단어 (중지 단어라고 함)는 일반적으로 반전 인덱스에 포함되지 않습니다.

일부 데이터베이스에서 직접 전체 텍스트 검색을 수행 할 수 있지만 (예 : MySQL은 전체 텍스트 검색을 지원함 ) 반전 된 인덱스를 계산 및 저장하고 쿼리 인터페이스를 제공하는 별도의 "검색 서비스"를 실행하는 것이 일반적입니다. Sphinx 또는 Apache Solr 과 같은 다른 옵션이 있지만 오늘날 가장 널리 사용되는 전체 텍스트 검색 플랫폼은 Elasticsearch 입니다.

## 8. 서비스

앱이 특정 규모에 도달하면 별도의 애플리케이션으로 실행되도록 일부 "서비스"가 제공 될 수 있습니다. 외부 세계에 노출되지 않지만 앱 및 기타 서비스는 외부 세계와 상호 작용합니다. 예를 들어 스토리 블록에는 여러 가지 운영 및 계획된 서비스가 있습니다.

- 계정 서비스 는 모든 사이트에 걸쳐 사용자 데이터를 저장하므로 교차 판매 기회를 쉽게 제공하고보다 통합 된 사용자 경험을 만들 수 있습니다
- 컨텐츠 서비스 는 모든 비디오, 오디오 및 이미지 컨텐츠에 대한 메타 데이터를 저장합니다. 또한 컨텐츠를 다운로드하고 다운로드 기록을 볼 수있는 인터페이스도 제공합니다.
- 결제 서비스 는 고객 신용 카드 결제를위한 인터페이스를 제공 합니다.
- HTML → PDF 서비스 는 HTML을 받아들이고 해당 PDF 문서를 반환하는 간단한 인터페이스를 제공 합니다.

## 9. 데이터

오늘날 기업은 데이터를 얼마나 잘 활용하고 있는지에 따라 살고 죽습니다. 요즘 거의 모든 앱이 특정 규모에 도달하면 데이터 파이프 라인을 활용하여 데이터를 수집, 저장 및 분석 할 수 있습니다. 일반적인 파이프 라인에는 세 가지 주요 단계가 있습니다.

1. 이 앱은 일반적으로 사용자 상호 작용에 대한 이벤트 인 데이터를 "firehose"로 전송하여 데이터를 수집하고 처리하는 스트리밍 인터페이스를 제공합니다. 종종 원시 데이터가 변환되거나 기능 보강되어 다른 firehose로 전달되기도합니다. AWS Kinesis와 Kafka는이 목적을위한 가장 일반적인 기술입니다.
2. 원시 데이터와 최종 변환 / 증강 된 데이터는 클라우드 스토리지에 저장됩니다. AWS Kinesis는 "firehose"라는 설정을 제공하여 원시 데이터를 클라우드 스토리지 (S3)에 매우 쉽게 구성 할 수 있도록합니다.
3. 변환 / 증강 된 데이터는 종종 분석을 위해 데이터웨어 하우스에로드됩니다. 우리는 스타트 업 세계에서 점점 더 많은 부분을 차지하는 것처럼 AWS Redshift를 사용하지만 대기업은 종종 Oracle 또는 기타 독점웨어 하우스 기술을 사용합니다. 데이터 세트가 충분히 큰 경우 분석에 Hadoop과 유사한 NoSQL MapReduce 기술이 필요할 수 있습니다.

아키텍처 다이어그램에는 표시되지 않은 또 다른 단계 : 앱 및 서비스 운영 데이터베이스에서 데이터웨어 하우스로 데이터로드 예를 들어 Storyblocks에서는 VideoBlocks, AudioBlocks, Storyblocks, 계정 서비스 및 기고자 포털 데이터베이스를 매일 밤마다 Redshift에로드합니다. 이는 핵심 비즈니스 데이터와 사용자 상호 작용 이벤트 데이터를 함께 배치함으로써 분석가에게 전체적인 데이터 세트를 제공합니다.

## 10. 클라우드 스토리지

AWS에 따르면 “클라우드 스토리지는 인터넷을 통해 데이터를 저장, 액세스 및 공유 할 수있는 간단하고 확장 가능한 방법 입니다. HTTP를 통해 RESTful API를 통해 파일과 상호 작용할 수 있다는 이점을 통해 로컬 파일 시스템에 저장하는 모든 항목을 저장하고 액세스하는 데 사용할 수 있습니다. Amazon의 S3 오퍼링은 오늘날 가장 인기있는 클라우드 스토리지이며 Storyblocks에서 광범위하게 비디오, 사진 및 오디오 자산, CSS 및 Javascript, 사용자 이벤트 데이터 등을 저장합니다.

## 11. CDN

CDN은 "Content Delivery Network"의 약자이며이 기술은 정적 HTML, CSS, Javascript 및 이미지와 같은 자산을 단일 원본 서버에서 제공하는 것보다 훨씬 빠르게 웹을 통해 제공하는 방법을 제공합니다. 전 세계의 많은 "에지"서버에 콘텐츠를 배포하여 사용자가 원본 서버 대신 "에지"서버에서 자산을 다운로드하도록합니다. 예를 들어 아래 이미지에서 스페인의 사용자는 NYC에 오리진 서버가있는 사이트에서 웹 페이지를 요청하지만 페이지의 정적 자산은 영국의 CDN "에지"서버에서로드되어 대서양의 느린 대서양 HTTP를 방지합니다. 요청.

**Ref**

- https://engineering.videoblocks.com/web-architecture-101-a3224e126947
